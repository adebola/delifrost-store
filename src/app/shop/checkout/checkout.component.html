<section class="section-b-space">
  <div class="container padding-cls">
    <div class="checkout-page">
      <div class="checkout-form">
        <form>
          <div class="row">
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 alert alert-warning mx-auto" role="alert"
              *ngIf="alertMessage">
              {{ alertMessage }}
            </div>
            <div class="col-lg-6 col-sm-12 col-xs-12 mx-auto" *ngIf="delivery">
              <div class="checkout-title">
                <h3>Delivery Details</h3>
              </div>

              <div class="row check-out">
                <div class="form-group col-12">
                  <div class="field-label">Full Name</div>
                  <input type="text" name="firstname" [formControl]="checkoutForm.controls['firstname']" value=""
                    placeholder="" autocomplete="off" />
                  <div *ngIf="
                      checkoutForm.controls.firstname.touched &&
                      checkoutForm.controls.firstname.errors?.required
                    " class="text text-danger">
                    Full Name is required.
                  </div>
                  <div *ngIf="
                      checkoutForm.controls.firstname.touched &&
                      checkoutForm.controls.firstname.errors?.pattern
                    " class="text text-danger">
                    Full Name must be alphabets.
                  </div>
                </div>

                <div class="form-group col-md-6 col-sm-6 col-xs-12">
                  <div class="field-label">Phone</div>
                  <input type="text" name="phone" [formControl]="checkoutForm.controls['phone']" value="" placeholder=""
                    autocomplete="off" />
                  <div *ngIf="
                      checkoutForm.controls.phone.touched &&
                      checkoutForm.controls.phone.errors?.required
                    " class="text text-danger">
                    Phone No is required.
                  </div>
                  <div *ngIf="
                      checkoutForm.controls.phone.touched &&
                      checkoutForm.controls.phone.errors?.pattern
                    " class="text text-danger">
                    Phone No is must be number.
                  </div>
                </div>
                <div class="form-group col-md-6 col-sm-6 col-xs-12">
                  <div class="field-label">Email Address</div>
                  <input type="text" name="email" [formControl]="checkoutForm.controls['email']" value="" placeholder=""
                    autocomplete="off" />
                  <div *ngIf="
                      checkoutForm.controls.email.touched &&
                      checkoutForm.controls.email.errors?.required
                    " class="text text-danger">
                    Email is required
                  </div>
                  <div *ngIf="
                      checkoutForm.controls.email.touched &&
                      checkoutForm.controls.email.errors?.email
                    " class="text text-danger">
                    Invalid Email
                  </div>
                </div>

                <div class="form-group col-md-12 col-sm-12 col-xs-12">
                  <div class="field-label">Address</div>

                  <div class="row mb-2">
                    <div class="col-6">
                      <div class="select" *ngIf="(addressService.addresses$ | async) as addresses">
                        <select (change)="onSelectChange($event.target.value)">
                          <option *ngFor="let address of addresses" [value]="address.id">
                            {{ address.address | slice:0:12 }}
                          </option>
                        </select>
                      </div>
                    </div>
                  </div>

                  <textarea id="address" name="address" [formControl]="checkoutForm.controls['address']" value=""
                    placeholder="" rows="6"></textarea>
                  <div *ngIf="
                      checkoutForm.controls.address.touched &&
                      checkoutForm.controls.address.errors?.required
                    " class="text text-danger">
                    Address is required
                  </div>
                  <div *ngIf="
                      checkoutForm.controls.address.touched &&
                      checkoutForm.controls.address.errors?.maxlength
                    " class="text text-danger">
                    Maximum 50 character
                  </div>
                </div>

                <div class="ml-3">
                  <button class="btn-solid btn" (click)="QuickAddressView.openModal()">
                    Addresses
                  </button>
                </div>

              </div>
            </div>

            <div class="col-lg-6 col-sm-12 col-xs-12 mx-auto">
              <div class="checkout-details">
                <div class="order-box">
                  <div class="title-box">
                    <div>Product <span> Total</span></div>
                  </div>
                  <ul class="qty" *ngIf="products.length">
                    <li *ngFor="let product of products">
                      <div *ngFor="let bundle of product.bundles">
                        <ng-container *ngIf="bundle.quantity > 0">
                          {{ product.name }} Ã— {{ bundle.quantity }}
                          <span>
                            {{
                            (bundle.price | discount: product) *
                              productService?.Currency.price
                              | currency
                                : productService?.Currency.currency
                                : "symbol"
                          }}
                          </span>
                        </ng-container>
                      </div>

                    </li>
                  </ul>
                  <ul class="qty" *ngIf="!products.length">
                    <li class="empty-checkout">
                      There are no products in cart
                    </li>
                  </ul>
                  <ul class="sub-total">
                    <li *ngIf="products.length">
                      Shipping
                      <div class="shipping">
                        <div class="shopping-option">
                          <input type="radio" name="shipping" (change)="onChange('pickup')" [checked]="true"
                                 id="local-pickup" />
                          <label for="local-pickup">Local Pickup</label>
                        </div>
                        <div class="shopping-option">
                          <input type="radio" (change)="onChange('deliver')" name="shipping" id="free-shipping" />
                          <label for="free-shipping">Delivery</label>
                        </div>
                      </div>
                    </li>
                    <hr/>
                    <li>
                      Sub-Total
                      <span class="count">{{
                        this.cartService.cartSubTotal
                          | currency: productService?.Currency.currency:"symbol"
                      }}</span>
                    </li>
                    <li>
                      VAT
                      <span class="count">{{
                        this.cartService.cartVAT
                                | currency: productService?.Currency.currency:"symbol"
                        }}</span>
                    </li>
                  </ul>
                  <ul class="total">
                    <li>
                      Total
                      <span class="count">{{
                        getTotal
                          | currency: productService?.Currency.currency:"symbol"
                      }}</span>
                    </li>
                  </ul>
                </div>
                <div class="text-right">
                  <button type="submit" [disabled]="!formValid" class="btn-solid btn" (click)="checkOut()">
                    Place Order
                  </button>
                </div>
              </div>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
</section>
<app-quick-address-view #quickAddressView></app-quick-address-view>
